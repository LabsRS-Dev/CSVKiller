(function(factory){"use strict";if(typeof define==="function"&&define.amd){define("BS.b$",["jquery"],function(){return factory(jQuery||$)})}else{factory(jQuery||$)}if(typeof module==="object"&&typeof module.exports==="object"){module.exports=factory(jQuery||$)}})(function($){"use strict";(function(){window["BS"]=window["BS"]||{};window.BS.b$=window.BS.b$||{}})();(function($){$.toJSON=$.toJSON||JSON.stringify;var b$={};b$.version="20150213";b$=$.extend(window.BS.b$,{});b$.pN=b$.pNative=typeof maccocojs!=="undefined"&&maccocojs;b$._ncb_idx=0;b$._get_callback=function(func,noDelete){window._nativeCallback=window._nativeCallback||{};var _nativeCallback=window._nativeCallback;var r="ncb"+b$._ncb_idx++;_nativeCallback[r]=function(){try{if(!noDelete){delete _nativeCallback[r]}}catch(e){console.error(e)}func&&func.apply(null,arguments)};return"_nativeCallback."+r};b$.cb_execTaskUpdateInfo=null;b$.pCorePlugin={useThread:true,passBack:"BS.b$.cb_execTaskUpdateInfo",packageMode:"bundle",taskToolPath:"/Plugins/extendLoader.bundle",bundleClassName:"LibCommonInterface"};b$.pIAPPlugin={path:"/plugin.iap.bundle"};b$.cb_handleIAPCallback=null;b$.IAP={enableIAP:function(parms){if(b$.pN){try{b$.pN.iap.regeditIAPCallbackJs(parms.cb_IAP_js||"BS.b$.cb_handleIAPCallback");b$.pN.iap.regeditIAPCore($.toJSON({path:b$.getAppPluginDir()+b$.pIAPPlugin.path}));if(b$.pN.iap.canMakePayments()){b$.pN.iap.startIAPService();b$.pN.iap.requestProducts($.toJSON({productIdentifiers:parms.productIds||[]}))}}catch(e){console.error(e)}}},restore:function(){if(b$.pN){b$.pN.iap.restoreIAP()}},buyProduct:function(parms){if(b$.pN){b$.pN.iap.buyProduct($.toJSON({identifier:parms.productIdentifier,quantity:parms.quantity||1}))}},getPrice:function(productIdentifier){if(b$.pN){return b$.pN.iap.getPrice(productIdentifier)}return""},getUseableProductCount:function(productIdentifier){if(b$.pN){return b$.pN.iap.getUseableProductCount(productIdentifier)}return 0},setUseableProductCount:function(jsonObj){if(b$.pN){var params={identifier:jsonObj.productIdentifier||"",quantity:jsonObj.quantity||1};return b$.pN.iap.setUseableProductCount($.toJSON(params))}return 0},add1Useable:function(productIdentifier){if(b$.pN){return b$.pN.iap.add1Useable(productIdentifier)}return 0},sub1Useable:function(productIdentifier){if(b$.pN){return b$.pN.iap.sub1Useable(productIdentifier)}return 0}};b$.Notice={alert:function(jsonObj){if(b$.pN){var params={message:jsonObj.message||"Tip",title:jsonObj.title||"title",buttons:jsonObj.buttons||["Ok"],alertType:jsonObj.alertType||"Alert"};return b$.pN.notice.alert($.toJSON(params))}else{alert(jsonObj.message)}}};b$.App={appName:null,getAppName:function(){if(b$.pN){var t=this;if(t.appName)return t.appName;t.appName=b$.pN.app.getAppName();return t.appName}return"AppName"},appVersion:null,getAppVersion:function(){if(b$.pN){var t=this;if(t.appVersion)return t.appVersion;t.appVersion=b$.pN.app.getAppVersion();return t.appVersion}return"4.5.6"},appId:null,getAppId:function(){if(b$.pN){var t=this;if(t.appId)return t.appId;t.appId=b$.pN.app.getAppIdentifier();return t.appId}return"AppID"},getSandboxEnable:function(){if(b$.pN){var sandboxEnable=b$.pN.app.getSandboxEnable();return sandboxEnable}return false},getRegInfoJSONString:function(){if(b$.pN){var str=b$.pN.app.getRegInfoJSONString();return str}return""},getSerialNumber:function(){if(b$.pN){var str=b$.pN.app.getStringSerialNumber();return str}return""},getLocalIP:function(){if(b$.pN){var str=b$.pN.app.getLocalIP();return str}return""},open:function(data){if(b$.pN){return b$.pN.app.open(data)}else{try{window.open(data)}catch(e){}}},isStartAtLogin:function(){if(b$.pN){return b$.pN.app.isStartAtLogin()}return false},setStartAtLogin:function(enable){if(b$.pN){return b$.pN.app.setStartAtLogin(enable)}},setInfoToUserDefaults:function(jsonObj){if(b$.pN){var obj=jsonObj||{callback:"console.log",key:"",value:""};b$.pN.window.setInfoToUserDefaults($.toJSON(obj))}},getInfoFromUserDefaults:function(jsonObj){if(b$.pN){var obj=jsonObj||{callback:"console.log",key:""};b$.pN.window.getInfoFromUserDefaults($.toJSON(obj))}},removeItemFromUserDefaults:function(jsonObj){if(b$.pN){var obj=jsonObj||{callback:"console.log",key:""};b$.pN.window.removeItemFromUserDefaults($.toJSON(obj))}},setOptions_RateAppClose:function(enable){b$.App.setInfoToUserDefaults({key:"RateApp_CLOSE",value:enable})},getServerPort:function(){if(b$.pN){return b$.pN.app.getHttpServerPort()}return 8888},getAppPluginDir:b$.getAppPluginDir=function(){if(b$.pN){return b$.pN.path.appPluginDirPath()}return""},getAppResourcePublicDir:b$.getAppResourcePublicDir=function(){if(b$.pN){return b$.pN.path.resource()+"/public"}return""},checkPathIsExist:b$.pathIsExist=function(path){if(b$.pN){return b$.pN.path.pathIsExist(path)}return false},checkFileIsZero:b$.checkFileIsZeroSize=function(file_path){if(b$.pN){return b$.pN.path.fileIsZeroSize(file_path)}return false},checkPathIsWritable:b$.checkPathIsWritable=function(path){if(b$.pN){return b$.pN.path.checkPathIsWritable(path)}return false},createEmptyFile:b$.createEmptyFile=function(file_path){if(b$.pN){return b$.pN.window.createEmptyFile($.toJSON({path:file_path}))}},removeFile:b$.removeFile=function(file_path){if(b$.pN){return b$.pN.window.removeFile($.toJSON({path:file_path}))}},findFile:b$.findFile=function(dir,fileName){if(b$.pN){return b$.pN.window.findFile($.toJSON({dir:dir,fileName:fileName}))}return null},checkPathIsReadable:function(path){if(b$.pN){return b$.pN.path.checkPathIsReadable(path)}return false},checkPathIsExecutable:function(path){if(b$.pN){return b$.pN.path.checkPathIsExecutable(path)}return false},checkPathIsDeletable:function(path){if(b$.pN){return b$.pN.path.checkPathIsDeletable(path)}return false},checkPathIsFile:function(path){if(b$.pN){return b$.pN.path.checkPathIsFile(path)}return false},checkPathIsDir:function(path){if(b$.pN){return b$.pN.path.checkPathIsDir(path)}return false},getFileExt:function(path){if(b$.pN){return b$.pN.path.getFileExt(path)}return""},getPathParentPath:function(path){if(b$.pN){return b$.pN.path.getPathParentPath(path)}return""},getFilePropertyJSONString:function(path){if(b$.pN){return b$.pN.path.getFilePropertyJSONString(path)}return""},fileSizeAtPath:function(path){if(b$.pN){return b$.pN.app.fileSizeAtPath(path)}return""},diskSizeAtPath:function(path){if(b$.pN){return b$.pN.app.diskSizeAtPath(path)}return""},md5Digest:function(str){if(b$.pN){return b$.pN.app.md5Digest(str)}return""},getAppleLanguage:function(){if(b$.pN){return b$.pN.app.curAppleLanguage()}return"en-US"},getCompatibleWebkitLanguageList:function(_getType){var getType=_getType||"Native2Webkit";var defaultLanguage="en";var NativeApple2WebKit_LanguageMap={Unknown:[""],en:["en","en-US","en-us"],fr:["fr","fr-FR","fr-fr"],de:["de","de-DE","de-de"],"zh-Hans":["zh","zh-CN","zh-cn","zh-Hans"],"zh-Hant":["zh-TW","zh-tw","zh-Hant"],ja:["ja","ja-JP","ja-jp"],es:["es","es-ES","es-es"],"es-MX":["es-MX","es-XL","es-xl"],it:["it","it-IT","it-it"],nl:["nl","nl-NL","nl-nl"],ko:["ko","ko-KR","ko-kr"],pt:["pt","pt-BR","pt-br"],"pt-PT":["pt-PT","pt-pt"],da:["da","da-DK","da-da"],fi:["fi","fi-FI","fi-fi"],nb:["nb","nb-NO","nb-no"],sv:["sv","sv-SE","sv-se"],ru:["ru","ru-RU","ru-ru"],pl:["pl","pl-PL","pl-pl"],tr:["tr","tr-TR","tr-tr"],ar:["ar","AR"],th:["th","th-TH","th-th"],cs:["cs","cs-CZ","cs-cz"],hu:["hu","hu-HU","hu-hu"],ca:["ca","ca-ES","ca-es"],hr:["hr","hr-HR","hr-hr"],el:["el","el-GR","el-gr"],he:["he","he-IL","he-il"],ro:["ro","ro-RO","ro-ro"],sk:["sk","sk-SK","sk-sk"],uk:["uk","uk-UA","uk-ua"],id:["id","ID","id-ID","id-id"],ms:["ms","MS","ms-MS","ms-ms"],vi:["vi","vi-VN","vi-vn"]};if(getType==="Native2Webkit"){var apple_lng="en-US";if(b$.pN){apple_lng=b$.pN.app.getAppleLanguage()}if(NativeApple2WebKit_LanguageMap.hasOwnProperty(apple_lng)){return NativeApple2WebKit_LanguageMap[apple_lng]}return NativeApple2WebKit_LanguageMap[defaultLanguage]}else if(getType==="webkitCompatible"){var mapValue=null,webLanguage=navigator.language||"en";var inArray=function(value,array){if(Array.prototype.indexOf){return array.indexOf(value)}else{for(var i=0;i<array.length;i++){if(array[i]===value)return i}return-1}};for(var key in NativeApple2WebKit_LanguageMap){if(NativeApple2WebKit_LanguageMap.hasOwnProperty(key)){var languageArray=NativeApple2WebKit_LanguageMap[key];if(inArray(webLanguage,languageArray)>-1){mapValue=languageArray;break}}}return mapValue}return console.error("调用方式不正确，需要的参数为:Native2Webkit 或者webkitCompatible")}};b$.Clipboard={copy:function(stringText){if(b$.pN){b$.pN.clipboard.copy(stringText)}},paste:function(){if(b$.pN){b$.pN.clipboard.paste()}}};b$.Dock={setBadge:function(text){if(b$.pN){b$.pN.dock.setBadge(text)}},getBadge:function(){if(b$.pN){return b$.pN.dock.badge()}return"dock"}};b$.enablePluginCore=function(pluginList){if(b$.pN){try{var org_pluginArray=pluginList||[];var pluginArray=[];for(var i=0;i<org_pluginArray.length;++i){var plugin=org_pluginArray[i];if(plugin["callMethod"]==="call"){pluginArray.push(plugin)}}var extendObj=$.objClone(b$.pCorePlugin);extendObj["callMethod"]="initCore";extendObj["arguments"]=[true,pluginArray];b$.pN.window.execTask($.toJSON(extendObj))}catch(e){console.error(e)}}};b$.cb_dragdrop=null;b$.enableDragDropFeature=function(parms){if(b$.pN){try{parms=parms||{};parms["callback"]=parms["callback"]||"BS.b$.cb_dragdrop";parms["enableDir"]=parms["enableDir"]||false;parms["enableFile"]=parms["enableFile"]||true;parms["fileTypes"]=parms["fileTypes"]||["*"];b$.pN.window.setDragDropConfig($.toJSON(parms))}catch(e){console.error(e)}}};b$.createTask=function(callMethod,taskId,args,cbFuncName){if(b$.pN){try{var extendObj=$.objClone(b$.pCorePlugin);extendObj["passBack"]=cbFuncName||extendObj["passBack"];extendObj["callMethod"]=callMethod;extendObj["arguments"]=[taskId,args];b$.pN.window.execTask($.toJSON(extendObj))}catch(e){console.error(e)}}};b$.sendQueueEvent=function(queueID,queueType,event){if(b$.pN){try{var extendObj=$.objClone(b$.pCorePlugin);extendObj["callMethod"]="sendEvent";extendObj["arguments"]=[event,queueType,queueID];b$.pN.window.execTask($.toJSON(extendObj))}catch(e){console.error(e)}}};b$.cb_importFiles=null;b$.importFiles=function(parms){if(b$.pN){try{parms=parms||{};parms["callback"]=parms["callback"]||"BS.b$.cb_importFiles";parms["title"]=parms["title"]||"Select a file";parms["prompt"]=parms["prompt"]||"Open";parms["allowOtherFileTypes"]=parms["allowOtherFileTypes"]||false;parms["allowMulSelection"]=parms["allowMulSelection"]||false;parms["canCreateDir"]=parms["canCreateDir"]||false;parms["canChooseFiles"]=true;parms["canChooseDir"]=false;parms["types"]=parms["types"]||[];b$.pN.window.openFile($.toJSON(parms))}catch(e){console.error(e)}}else{alert("启动选择文件对话框!")}};b$.cb_selectOutDir=null;b$.selectOutDir=function(parms){if(b$.pN){try{parms=parms||{};parms["callback"]=parms["callback"]||"BS.b$.cb_selectOutDir";parms["title"]=parms["title"]||"Select Directory";parms["prompt"]=parms["prompt"]||"Select";parms["allowOtherFileTypes"]=false;parms["canCreateDir"]=parms["canCreateDir"]||true;parms["canChooseDir"]=true;parms["canChooseFiles"]=false;parms["types"]=[];b$.pN.window.openFile($.toJSON(parms))}catch(e){console.error(e)}}else{alert("启动选择目录对话框!")}};b$.cb_selectOutFile=null;b$.selectOutFile=function(parms){if(b$.pN){try{parms=parms||{};parms["callback"]=parms["callback"]||"BS.b$.cb_selectOutFile";parms["title"]=parms["title"]||"Save as";parms["prompt"]=parms["prompt"]||"Save";parms["allowOtherFileTypes"]=false;parms["canCreateDir"]=parms["canCreateDir"]||true;parms["fileName"]=parms["fileName"]||"untitled",parms["types"]=parms["types"]||["*"];b$.pN.window.saveFile($.toJSON(parms))}catch(e){console.error(e)}}else{alert("启动选择输出文件对话框!")}};b$.cb_revealInFinder=null;b$.revealInFinder=function(path){if(b$.pN){try{b$.pN.window.revealInFinder($.toJSON({filePath:path}))}catch(e){console.error(e)}}};b$.check_supportHtml5Storage=function(){try{return"localStorage"in window&&window["localStorage"]!=null}catch(e){return false}};b$.defaultManifest_key="js_defaultManifest_key";b$.defaultManifest={};b$.saveDefaultManifest=function(newManifest){if(!b$.check_supportHtml5Storage())return false;var obj={manifest:newManifest||b$.defaultManifest};var encoded=$.toJSON(obj);window.localStorage.setItem(b$.defaultManifest_key,encoded);return true};b$.revertDefaultManifest=function(){if(!b$.check_supportHtml5Storage())return false;var encoded=window.localStorage.getItem(b$.defaultManifest_key);if(encoded!=null){var obj=$.secureEvalJSON(encoded);b$.defaultManifest=obj.manifest}return true};window.BS.b$=$.extend(window.BS.b$,b$)})($);return window.BS.b$});